<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tool Browser</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="navbar.css">
</head>
<body>

    <div class="container">
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        <div class="sidebar" id="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">Tools</div>
                <div class="sidebar-item" data-category="health">
                    <div class="sidebar-icon"></div>
                    Health & Wellness
                </div>
                <div class="sidebar-item active" data-category="ai">
                    <div class="sidebar-icon"></div>
                    AI Assistance
                </div>
                <div class="sidebar-item" data-category="learning">
                    <div class="sidebar-icon"></div>
                    Learning & Engagement
                </div>
                <div class="sidebar-item" data-category="scheduling">
                    <div class="sidebar-icon"></div>
                    Scheduling & Reminders
                </div>
                <div class="sidebar-item" data-category="utilities">
                    <div class="sidebar-icon"></div>
                    Utilities
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="content-header">
                <h1 class="content-title" id="categoryTitle">AI Assistance</h1>
                <div class="search-container">
                    <div class="search-icon"></div>
                    <input type="text" class="search-input" placeholder="Search a tool" id="searchInput">
                </div>
            </div>

            <div class="tools-grid" id="toolsGrid">
                <!-- AI Assistance Tools -->
                <div class="tool-card" onclick="openTool('/aichat/aichat.html')">
                    <div class="tool-icon chat">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">AI Chat Bot</h3>
                    <p class="tool-description">Get instant help and answers anytime using our smart assistant.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('aichat/aichat.html')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>

                <div class="tool-card" onclick="openTool('#')">
                    <div class="tool-icon summarizer">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">Summarizer</h3>
                    <p class="tool-description">Instantly get summaries of long text or websites/links for easy reading.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('#')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>

                <!-- Health & Wellness Tools -->
                <div class="tool-card health-tool" style="display: none;" onclick="openTool('meal-planner/meal.html')">
                    <div class="tool-icon chat">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">Meal Planner</h3>
                    <p class="tool-description">Plan your weekly meals and generate grocery lists automatically.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('meal-planner/meal.html')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>

                <div class="tool-card health-tool" style="display: none;" onclick="openTool('grocery-list/grocery.html')">
                    <div class="tool-icon summarizer">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">Grocery List</h3>
                    <p class="tool-description">Smart grocery lists with units, auto-generated from your meal plans.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('grocery-list/grocery.html')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>

                <div class="tool-card health-tool" style="display: none;" onclick="openTool('#')">
                    <div class="tool-icon chat">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">Health Tracker</h3>
                    <p class="tool-description">Monitor your daily health metrics and wellness goals.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('#')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>

                <div class="tool-card health-tool" style="display: none;" onclick="openTool('#')">
                    <div class="tool-icon summarizer">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">Meditation Guide</h3>
                    <p class="tool-description">Guided meditation sessions for stress relief and mindfulness.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('#')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>

                <!-- Learning & Engagement Tools -->
                <div class="tool-card learning-tool" style="display: none;" onclick="openTool('#')">
                    <div class="tool-icon chat">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">Study Planner</h3>
                    <p class="tool-description">Organize your study schedule and track learning progress.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('#')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>

                <div class="tool-card learning-tool" style="display: none;" onclick="openTool('#')">
                    <div class="tool-icon summarizer">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">Quiz Generator</h3>
                    <p class="tool-description">Create interactive quizzes to test your knowledge.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('#')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>

                <!-- Scheduling & Reminders Tools -->
                <div class="tool-card scheduling-tool" style="display: none;" onclick="openTool('#')">
                    <div class="tool-icon chat">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">Task Manager</h3>
                    <p class="tool-description">Organize and prioritize your daily tasks efficiently.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('#')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>

                <div class="tool-card scheduling-tool" style="display: none;" onclick="openTool('#')">
                    <div class="tool-icon summarizer">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">Calendar Sync</h3>
                    <p class="tool-description">Sync and manage events across all your calendars.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('#')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>

                <!-- Utilities Tools -->
                <div class="tool-card utilities-tool" style="display: none;" onclick="openTool('#')">
                    <div class="tool-icon chat">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">File Converter</h3>
                    <p class="tool-description">Convert files between different formats quickly and easily.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('#')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>

                <div class="tool-card utilities-tool" style="display: none;" onclick="openTool('#')">
                    <div class="tool-icon summarizer">
                        <div style="width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 4px;"></div>
                    </div>
                    <h3 class="tool-title">Password Generator</h3>
                    <p class="tool-description">Generate secure passwords for all your accounts.</p>
                    <button class="tool-button" onclick="event.stopPropagation(); openTool('#')">
                        Open Tool
                        <div class="button-icon"></div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // Authentication check
        document.addEventListener('DOMContentLoaded', function() {
            const token = localStorage.getItem('authToken');
            const currentUser = localStorage.getItem('currentUser');
            
            if (!token) {
                                    // Redirect to login if not authenticated
                    window.location.href = 'login/login.html';
                    return;
                }
                
                // Display user info
                if (currentUser) {
                    try {
                        const user = JSON.parse(currentUser);
                        document.getElementById('userName').textContent = user.name || 'User';
                    } catch (e) {
                        console.error('Error parsing user data:', e);
                    }
                }
                
                
                logoutBtn.addEventListener('click', async function() {
                    console.log('Logout button clicked');
                    try {
                        console.log('Attempting logout with token:', token);
                        const response = await fetch('http://127.0.0.1:3000/auth/logout', {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${token}`,
                                'Content-Type': 'application/json'
                            },
                            credentials: 'include'
                        });
                        
                        console.log('Logout response:', response.status);
                        
                        // Clear localStorage regardless of server response
                        localStorage.removeItem('authToken');
                        localStorage.removeItem('currentUser');
                        
                        console.log('LocalStorage cleared, redirecting to login');
                        // Redirect to login
                        window.location.href = 'login/login.html';
                    } catch (error) {
                        console.error('Logout error:', error);
                        // Still clear localStorage and redirect
                        localStorage.removeItem('authToken');
                        localStorage.removeItem('currentUser');
                        console.log('Error occurred, still redirecting to login');
                        window.location.href = 'login/login.html';
                }
            });
            
            // Profile dropdown toggle
            const profileSection = document.querySelector('.profile');
            console.log('Profile section found:', profileSection);
            
            if (profileSection) {
                profileSection.addEventListener('click', function() {
                    console.log('Profile clicked, toggling dropdown');
                    document.getElementById('profileDropdown').classList.toggle('show');
                });
            }
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.profile')) {
                    document.getElementById('profileDropdown').classList.remove('show');
                }
            });
        });
    </script>
    <script src="navbar.js"></script>
</body>
</html>
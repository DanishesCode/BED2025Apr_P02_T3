<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tool Browser</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">
        <div class="header-left">
            <button class="menu-button" id="menuButton">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <div class="logo">Logo Here</div>
        </div>
        <div class="header-right">
            <div class="credit">Credit</div>
            <div class="profile" id="profileSection">
                <span id="userName">Guest</span>
                <div class="profile-icon">ðŸ‘¤</div>
                <div class="profile-dropdown" id="profileDropdown">
                    <div class="dropdown-item" id="logoutBtn">Logout</div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        <div class="sidebar" id="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">Tools</div>
                <div class="sidebar-item" data-category="health">
                    <img class="icon" src="assets/heart.svg" alt="">
                    Health & Wellness
                </div>
                <div class="sidebar-item active" data-category="ai">
                    <img class="icon" src="assets/ai.svg" alt="">
                    AI Assistance
                </div>
                <div class="sidebar-item" data-category="learning">
                    <img class="icon" src="assets/lightbulb.svg" alt="">
                    Learning & Engagement
                </div>
                <div class="sidebar-item" data-category="scheduling">
                    <img class="icon" src="assets/calendar.svg" alt="">
                    Scheduling & Reminders
                </div>
                <div class="sidebar-item" data-category="utilities">
                    <img class="icon" src="assets/tool-box.svg" alt="">
                    Utilities
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="content-header">
                <h1 class="content-title" id="categoryTitle">AI Assistance</h1>
                <div class="search-container">
                    <div class="search-icon"></div>
                    <input type="text" class="search-input" placeholder="Search a tool" id="searchInput">
                </div>
            </div>

            <div class="tools-grid" id="toolsGrid">
            


            </div>
        </div>
    </div>

    <script>
        // Tool navigation function
        function openTool(url) {
            if (url === '#') {
                alert('This tool is coming soon!');
                return;
            }
            window.location.href = url;
        }

        // Mobile menu toggle
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            const menuButton = document.getElementById('menuButton');
            
            if (sidebar && overlay && menuButton) {
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
                menuButton.classList.toggle('active');
            }
        }

        // Close sidebar
        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            const menuButton = document.getElementById('menuButton');
            
            if (sidebar && overlay && menuButton) {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
                menuButton.classList.remove('active');
            }
        }

        // Category switching functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Authentication check
            const token = localStorage.getItem('authToken');
            const currentUser = localStorage.getItem('currentUser');
            
            if (!token) {
                // Redirect to login if not authenticated
                window.location.href = 'http://localhost:3000/login';
                return;
            }
            
            // Display user info  
            if (currentUser) {
                try {
                    const user = JSON.parse(currentUser);
                    document.getElementById('userName').textContent = user.name || 'User';
                } catch (e) {
                    console.error('Error parsing user data:', e);
                }
            }

            // Setup menu button
            const menuButton = document.getElementById('menuButton');
            const sidebarOverlay = document.getElementById('sidebarOverlay');
            
            if (menuButton) {
                menuButton.addEventListener('click', toggleSidebar);
            }
            
            if (sidebarOverlay) {
                sidebarOverlay.addEventListener('click', closeSidebar);
            }

            // Setup logout functionality
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', async function() {
                    try {
                        const response = await fetch('http://localhost:3000/auth/logout', {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${token}`,
                                'Content-Type': 'application/json'
                            },
                            credentials: 'include'
                        });
                        
                        // Clear localStorage regardless of server response
                        localStorage.removeItem('authToken');
                        localStorage.removeItem('currentUser');
                        
                        // Redirect to login
                        window.location.href = 'login/login.html';
                    } catch (error) {
                        console.error('Logout error:', error);
                        // Still clear localStorage and redirect
                        localStorage.removeItem('authToken');
                        localStorage.removeItem('currentUser');
                        window.location.href = 'login/login.html';
                    }
                });
            }

            // Profile dropdown toggle
            const profileSection = document.querySelector('.profile');
            if (profileSection) {
                profileSection.addEventListener('click', function() {
                    document.getElementById('profileDropdown').classList.toggle('show');
                });
            }
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.profile')) {
                    document.getElementById('profileDropdown').classList.remove('show');
                }
            });

            // Category switching
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.addEventListener('click', () => {
                    const category = item.dataset.category;
                    
                    // Remove active class from all items
                    document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    
                    // Hide all tools
                    document.querySelectorAll('.tool-card').forEach(card => {
                        card.style.display = 'none';
                    });
                    
                    // Show tools for selected category
                    document.querySelectorAll(`.${category}-tool`).forEach(card => {
                        card.style.display = 'block';
                    });
                    
                    // Update title
                    const categoryNames = {
                        health: 'Health & Wellness',
                        ai: 'AI Assistance', 
                        learning: 'Learning & Engagement',
                        scheduling: 'Scheduling & Reminders',
                        utilities: 'Utilities'
                    };
                    document.getElementById('categoryTitle').textContent = categoryNames[category];

                    // Close sidebar on mobile after selection
                    if (window.innerWidth <= 768) {
                        closeSidebar();
                    }
                });
            });
        });
    </script>
</body>
</html>